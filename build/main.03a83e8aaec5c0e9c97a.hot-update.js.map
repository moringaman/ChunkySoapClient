{"version":3,"file":"main.03a83e8aaec5c0e9c97a.hot-update.js","sources":["webpack:///./src/containers/HomePage.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport { myApi } from \"../helpers\";\nimport { Hero, Container, Section } from \"../styles/layout\";\nimport { BannerHeading, BannerHeading2, SectionHeading } from \"../styles/typography\";\nimport { Bubble } from \"../styles/ui\";\nimport ProductSlider from \"../components/ui/ProductSlider\";\nimport WxButton from \"../styles/components/button\";\nimport { Modal, OptIn, ProductPreview, Footer, ProductSearch, CategoryRow } from \"../components\";\nimport useModal from \"../hooks/useModal\";\nimport * as vars from \"../styles/variables\";\nimport { isEmpty } from '../helpers/functions'\n\nexport default function HomePage(props) {\n  let featured\n  const products = useSelector((state) => state.products);\n  \n  if (products) { \n     featured =  products?.products.filter(\n      (el) => el.product_featured === true\n    ) \n  }\n\n  const popular = products?.products.sort((a, b) =>\n    a.product_sold_quantity > b.product_sold_quantity ? 1 : -1\n  );\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const { isShowing, toggle } = useModal({selectedProduct, products})\n  const [selectedProduct, setSelectedProduct] = useState({});\n  const [currentCart, setCurrentCart] = useState([]);\n  const envVar = process.env.RAZZLE_STRIPE_PRIVATE_KEY\n\n  // Optin State - later add to custom optin hook\n\n  const [optinMail, setOptinMail ] = useState({'email': ''})\n\n  useEffect(() => {\n    console.log(\"KEYS: \", envVar)\n    if (process.browser) {\n      const cartInStorage = localStorage.getItem(\"soap-cart\");\n      if (cartInStorage) {\n        setCurrentCart(JSON.parse(cartInStorage));\n        dispatch({\n          type: \"SET_INITIAL_BASKET\",\n          payload: JSON.parse(cartInStorage),\n        });\n      }\n    }\n    if (products.products.length) return;\n    _apiCall();\n  }, []);\n\n  const _apiCall = async () => {\n    const res = await myApi.send(\"/products\", \"GET\", undefined, \"public\");\n    console.log(\"MYAPI PRODUCTS \", res);\n    dispatch({ type: \"FETCH_PRODUCTS\", payload: res });\n    console.log(\"HOME PROPS \", props);\n  };\n\n  useEffect(() => {\n    console.log(\"Changed Cart\", currentCart);\n  }, [currentCart]);\n\n  const handleClick = (id) => {\n    console.log(\"event\");\n    const selected = products.products.filter((product) => product.id === id);\n    setSelectedProduct(selected[0]);\n    console.log(\"SELECTED\", selectedProduct);\n    toggle();\n  };\n\n  const viewProduct = (id) => {\n    history.push(`/product/${id}`);\n  };\n\n  return (\n    <>\n      <Hero>\n        <img\n          src=\"/drips.png\"\n          alt=\"drips\"\n          style={{\n            float: \"right\",\n            width: \"500px\",\n            transform: \"translateY(-30px)\",\n          }}\n        />\n        <img\n          src=\"/logo-big.svg\"\n          alt=\"chunky soap\"\n          style={{\n            float: \"left\",\n            width: \"450px\",\n            transform: \"translateX(-40px)\",\n          }}\n        />\n        <img\n          className=\"girl-pic\"\n          src=\"/girl.webp\"\n          alt=\"chunky soap girl\"\n          style={{\n            position: \"absolute\",\n            width: \"480px\",\n            transform: \"translateX(-120px)\",\n            top: 188,\n          }}\n        />\n        {vars.heroBubbles.map((b, i) => (\n          <Bubble {...b} key={i} />\n        ))}\n        <div\n          style={{ top: 260, left: \"800px\", width: 550, position: \"absolute\" }}\n        >\n          <BannerHeading>\n            Natural soap bars & creams for all skin types\n          </BannerHeading>\n          <BannerHeading2>Because beauty is a fragile gift..</BannerHeading2>\n          <WxButton primary big style={{marginLeft: '70px', marginTop: '50px'}}>\n            <div className=\"script-font\">\n             Visit Shop\n            </div>\n          </WxButton>\n        </div>\n      </Hero>\n      <Container>\n        <Bubbles>\n          {vars.bodyBubbles.map((b, i) => (\n            <Bubble {...b} key={i} />\n          ))}\n        </Bubbles>\n        <ProductSearch />\n        <SectionHeading>Featured Products</SectionHeading>\n        <ProductSlider perPage={3} data={featured} handleClick={handleClick} />\n        <CategoryRow/>\n        <SectionHeading>Most Popular Products</SectionHeading>\n        <ProductSlider perPage={3} data={popular} handleClick={handleClick} />\n      </Container>\n      <div style={{ marginTop: '-100px'}}>\n      <OptIn \n        cols=\"100%\" \n        height={200}\n        valid={false}\n        loading={false}\n        btnText=\"Subscribe\"\n        placeholder=\"your email address\" \n        label=\"Subscribe to our newsletter to get special deals\"\n        handleChange={(e) => {setOptinMail({...optinMail, ['email']: e.target.value})}}\n        handleSubmit={() => { console.log('submitting: ', optinMail)}}\n        />\n      </div>\n      <Footer height={800} />\n      <Modal isShowing={isShowing} hide={toggle}>\n        <ProductPreview product={selectedProduct} viewProduct={viewProduct} />\n      </Modal>\n    </>\n  );\n}\n\nconst Bubbles = styled.div`\n  overflow: hidden;\n`\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAGA;AACA;AACA;AAfA;AAeA;AAAA;AAAA;AAfA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAiBA;AACA;AAnBA;AAsBA;AAAA;AAtBA;AAAA;AAAA;AACA;AAuBA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAHA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AACA;AACA;AACA;AACA;AACA;AAHA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAEA;;;;A","sourceRoot":""}